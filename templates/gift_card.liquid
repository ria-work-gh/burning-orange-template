{% layout 'theme' %}

<style>
  .gift-card {
    padding: var(--spacing-l) var(--spacing-base);
    text-align: center;
  }

  @media (min-width: 600px) {
    .gift-card {
      padding: var(--spacing-xl) var(--spacing-m);
    }
  }

  .gift-card-container {
    max-width: 480px;
    margin-inline: auto;
  }

  .gift-card-heading {
    margin-bottom: var(--spacing-m);
  }

  .gift-card-image {
    margin-bottom: var(--spacing-m);
  }

  .gift-card-image img {
    width: 100%;
    height: auto;
    border-radius: 8px;
  }

  .gift-card-amount {
    margin-bottom: var(--spacing-m);
  }

  .gift-card-code-wrapper {
    margin-bottom: var(--spacing-base);
  }

  .gift-card-code {
    text-align: center;
    font-size: var(--type-medium-size);
    letter-spacing: 0.1em;
    margin-top: var(--spacing-xs);
  }

  .gift-card-qr {
    margin-bottom: var(--spacing-base);
  }

  .gift-card-expiry {
    margin-bottom: var(--spacing-m);
    color: var(--color-text-light);
  }

  .gift-card-expired {
    color: #dc2626;
  }

  .gift-card-actions {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-s);
    align-items: center;
  }

  @media (min-width: 600px) {
    .gift-card-actions {
      flex-direction: row;
      justify-content: center;
    }
  }

  @media print {
    .header,
    .footer,
    .announcement-bar,
    .gift-card-actions {
      display: none !important;
    }

    .gift-card {
      padding: 0;
    }

    .gift-card-code {
      border: 2px dashed black;
    }
  }
</style>

<div class="gift-card">
  <div class="gift-card-container">
    <h1 class="gift-card-heading text-large">
      {{ 'gift_cards.issued.title' | t }}
    </h1>

    {%- comment -%} Gift card image {%- endcomment -%}
    <div class="gift-card-image">
      <img
        src="{{ 'gift-card/card.jpg' | shopify_asset_url }}"
        alt="{{ shop.name }} {{ 'gift_cards.issued.title' | t }}"
        width="570"
        height="360"
        loading="eager"
      >
    </div>

    {%- comment -%} Amount {%- endcomment -%}
    {%- assign formatted_value = gift_card.balance | money -%}
    <p class="gift-card-amount text-xl">
      {%- if gift_card.balance != gift_card.initial_value -%}
        <span class="gift-card-balance">{{ 'gift_cards.issued.balance' | t: balance: formatted_value }}</span>
      {%- else -%}
        {{ formatted_value }}
      {%- endif -%}
    </p>

    {%- comment -%} Code {%- endcomment -%}
    <div class="gift-card-code-wrapper">
      <label for="gift-card-code" class="text-mini text-light">
        {{ 'gift_cards.issued.code' | t }}
      </label>
      <input
        type="text"
        id="gift-card-code"
        class="gift-card-code input"
        value="{{ gift_card.code | format_code }}"
        readonly
        aria-label="{{ 'gift_cards.issued.code' | t }}"
        onclick="this.select();"
      >
    </div>

    {%- comment -%} QR code {%- endcomment -%}
    <div class="gift-card-qr">
      <img
        src="{{ gift_card.qr_code_url }}"
        alt="{{ 'gift_cards.issued.qr_code_alt' | t: code: gift_card.code | format_code }}"
        width="120"
        height="120"
      >
    </div>

    {%- comment -%} Expiry {%- endcomment -%}
    {%- if gift_card.expires_on -%}
      <p class="gift-card-expiry text-mini {% if gift_card.expired %}gift-card-expired{% endif %}">
        {%- if gift_card.expired -%}
          {{ 'gift_cards.issued.expired' | t: expiry: gift_card.expires_on | date: format: 'abbreviated_date' }}
        {%- else -%}
          {{ 'gift_cards.issued.active' | t: expiry: gift_card.expires_on | date: format: 'abbreviated_date' }}
        {%- endif -%}
      </p>
    {%- else -%}
      <p class="gift-card-expiry text-mini">
        {{ 'gift_cards.issued.no_expiry' | t }}
      </p>
    {%- endif -%}

    {%- comment -%} Actions {%- endcomment -%}
    <div class="gift-card-actions">
      {%- if gift_card.pass_url -%}
        <a href="{{ gift_card.pass_url }}" class="button secondary">
          {{ 'gift_cards.issued.add_to_apple_wallet' | t }}
        </a>
      {%- endif -%}

      <button type="button" class="button secondary" onclick="window.print();">
        {{ 'gift_cards.issued.print' | t }}
      </button>

      <a href="{{ shop.url }}" class="button">
        {{ 'gift_cards.issued.shop_link' | t }}
      </a>
    </div>
  </div>
</div>

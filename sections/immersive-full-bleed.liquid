{%- comment -%} Immersive full bleed: background image with white text overlay and CTA. {%- endcomment -%}
<div class="immersive">
  {%- if section.settings.image != blank -%}
    {{
      section.settings.image
      | image_url: width: 2400
      | image_tag:
        loading: 'lazy',
        class: 'immersive-bg',
        sizes: '100vw',
        width: section.settings.image.width,
        height: section.settings.image.height
    }}
  {%- endif -%}

  <div class="immersive-overlay">
    {%- if section.blocks.size > 0 -%}
      <div class="immersive-type-block text-large">
        {%- for block in section.blocks -%}
          <p class="align-{{ block.settings.alignment }}" {{ block.shopify_attributes }}>
            {{ block.settings.text }}
          </p>
        {%- endfor -%}
      </div>
    {%- endif -%}

    {%- if section.settings.link_text != blank -%}
      <a class="immersive-link text-cap" href="{{ section.settings.link_url | default: '/collections' }}">
        {{ section.settings.link_text }}
      </a>
    {%- endif -%}
  </div>
</div>

{% stylesheet %}
  .immersive {
    position: relative;
    margin-top: var(--spacing-4);
  }

  .immersive-bg {
    width: 100%;
    height: auto;
    display: block;
  }

  .immersive-overlay {
    padding: var(--spacing-2);
    position: absolute;
    inset: 0;
    color: white;
    display: grid;
    grid-template-rows: 1fr auto;
    justify-items: center;
    align-items: center;
    gap: var(--spacing-2);
  }

  .immersive-type-block {
    width: 100%;
    max-width: 35ch;
    margin-inline: auto;
  }

  .immersive-link {
    color: white;
    transition: opacity var(--transition-fast);
  }

  .immersive-link:hover {
    opacity: 0.7;
  }

  .align-left {
    text-align: left;
  }

  .align-center {
    text-align: center;
  }

  .align-right {
    text-align: right;
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Immersive full bleed",
  "tag": "section",
  "class": "immersive-section",
  "settings": [
    {
      "type": "image_picker",
      "id": "image",
      "label": "Background image"
    },
    {
      "type": "text",
      "id": "link_text",
      "label": "Link text"
    },
    {
      "type": "url",
      "id": "link_url",
      "label": "Link URL",
      "default": "/collections"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme"
    }
  ],
  "blocks": [
    {
      "type": "line",
      "name": "Text line",
      "limit": 5,
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Text"
        },
        {
          "type": "select",
          "id": "alignment",
          "label": "Alignment",
          "options": [
            { "value": "left", "label": "Left" },
            { "value": "center", "label": "Center" },
            { "value": "right", "label": "Right" }
          ],
          "default": "center"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Immersive full bleed",
      "blocks": [
        {
          "type": "line",
          "settings": {
            "text": "Designed for life",
            "alignment": "center"
          }
        }
      ]
    }
  ]
}
{% endschema %}

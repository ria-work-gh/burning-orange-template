{%- if section.settings.heading != blank or section.blocks.size > 0 -%}
  <div class="text-section color-{{ section.settings.color_scheme }}">
    {%- if section.settings.heading != blank -%}
      <h2 class="text-section-heading text-cap">
        {{ section.settings.heading }}
      </h2>
    {%- endif -%}

    {%- if section.blocks.size > 0 -%}
      <div class="text-section-content">
        {%- for block in section.blocks -%}
          {%- case block.type -%}
            {%- when 'text' -%}
              {%- if block.settings.content != blank -%}
                <div class="text-section-text text-large typeset" {{ block.shopify_attributes }}>
                  {{ block.settings.content }}
                </div>
              {%- endif -%}

            {%- when 'accordion' -%}
              {%- if block.settings.question != blank -%}
                <details class="text-section-accordion" {{ block.shopify_attributes }}>
                  <summary class="text-section-accordion-trigger">
                    {{ block.settings.question }}
                    <span class="text-section-accordion-icon" aria-hidden="true">+</span>
                  </summary>
                  {%- if block.settings.answer != blank -%}
                    <div class="text-section-accordion-body typeset">
                      {{ block.settings.answer }}
                    </div>
                  {%- endif -%}
                </details>
              {%- endif -%}
          {%- endcase -%}
        {%- endfor -%}
      </div>
    {%- endif -%}
  </div>
{%- endif -%}

{% stylesheet %}
  .text-section {
    display: grid;
    gap: var(--spacing-2);
    padding: var(--spacing-4) var(--spacing-2);
  }

  @media (min-width: 900px) {
    .text-section {
      grid-template-columns: 1fr 2fr;
    }
  }

  .text-section-heading {
    margin: 0;
  }

  @media (min-width: 900px) {
    .text-section-heading {
      position: sticky;
      top: var(--spacing-5);
      align-self: start;
    }
  }

  .text-section-content {
    /* max-width: 720px; */
  }

  .text-section-text + .text-section-text,
  .text-section-text + .text-section-accordion,
  .text-section-accordion + .text-section-text {
    margin-top: var(--spacing-3);
  }

  .text-section-accordion + .text-section-accordion {
    margin-top: 0;
  }

  .text-section-accordion {
    border-top: 1px solid var(--color-text-light);
    max-width: 70ch;
  }

  .text-section-accordion:not(:has(+ .text-section-accordion)) {
    border-bottom: 1px solid var(--color-text-light);
  }

  .text-section-accordion-trigger {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-2) 0;
    cursor: pointer;
    list-style: none;
  }

  .text-section-accordion-trigger::-webkit-details-marker {
    display: none;
  }

  .text-section-accordion-icon {
    flex-shrink: 0;
    transition: transform var(--transition-fast);
    font-size: var(--type-medium-size);
    line-height: 1;
  }

  details[open] .text-section-accordion-icon {
    transform: rotate(45deg);
  }

  .text-section-accordion-body {
    padding: 0 0 var(--spacing-2) 0;
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Text section",
  "tag": "section",
  "class": "text-section-wrapper",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "About"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    }
  ],
  "blocks": [
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "richtext",
          "id": "content",
          "label": "Content",
          "default": "<p>Share your brand story or introduce your company.</p>"
        }
      ]
    },
    {
      "type": "accordion",
      "name": "Accordion",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "Question"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>Answer</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Text section",
      "blocks": [
        { "type": "text" },
        { "type": "text" },
        { "type": "accordion" },
        { "type": "accordion" },
        { "type": "accordion" }
      ]
    }
  ]
}
{% endschema %}

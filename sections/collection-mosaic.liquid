{%- comment -%} Collection mosaic: grid of collection cards with hover zoom and description. {%- endcomment -%}
<div class="mosaic{% if section.settings.color_scheme != blank %} color-{{ section.settings.color_scheme }}{% endif %}">
  {%- if section.settings.subheading != blank -%}
    <a class="text-cap inline-link" href="{{ routes.collections_url }}">{{ section.settings.subheading }}</a>
  {%- endif -%}
  {%- if section.settings.heading != blank -%}
    <h2 class="text-medium">{{ section.settings.heading }}</h2>
  {%- endif -%}

  {%- if section.blocks.size > 0 -%}
    <div class="mosaic-grid">
      {%- for block in section.blocks -%}
        {%- assign collection = block.settings.collection -%}
        <a href="{{ collection.url | default: routes.collections_url }}" class="mosaic-card" {{ block.shopify_attributes }}>
          <div class="mosaic-thumbnail">
            {%- if block.settings.image != blank -%}
              {{
                block.settings.image
                | image_url: width: 800
                | image_tag:
                  loading: 'lazy',
                  width: block.settings.image.width,
                  height: block.settings.image.height
              }}
            {%- elsif collection.image -%}
              {{
                collection.image
                | image_url: width: 800
                | image_tag:
                  loading: 'lazy',
                  width: collection.image.width,
                  height: collection.image.height
              }}
            {%- else -%}
              {{ 'collection-1' | placeholder_svg_tag: 'placeholder' }}
            {%- endif -%}
          </div>

          <div class="mosaic-card-info">
            <div class="mosaic-text-row">
              <h3 class="mosaic-card-name text-medium">
                {{ collection.title | default: 'Collection' }} <span class="mosaic-arrow">&rarr;</span>
              </h3>
              {%- if block.settings.description != blank -%}
                <p class="mosaic-card-description">{{ block.settings.description }}</p>
              {%- endif -%}
            </div>
          </div>
        </a>
      {%- endfor -%}
    </div>
  {%- endif -%}
</div>

{% stylesheet %}
  .mosaic {
    margin-top: var(--spacing-4);
    padding: var(--spacing-2);
    display: grid;
    gap: var(--spacing-2);
  }

  .mosaic-grid {
    display: grid;
    gap: var(--spacing-2);
    grid-template-columns: repeat(3, 1fr);
    max-width: 2000px;
    margin-inline: auto;
  }

  @media (max-width: 1023px) {
    .mosaic-grid {
      grid-template-columns: repeat(2, 1fr);
      row-gap: var(--spacing-2);
    }
  }

  @media (max-width: 749px) {
    .mosaic-grid {
      grid-template-columns: 1fr;
    }
  }

  .mosaic-card {
    display: grid;
    gap: var(--spacing-1);
    color: inherit;
  }

  .mosaic-thumbnail {
    aspect-ratio: 1 / 1;
    overflow: hidden;
  }

  .mosaic-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition-base);
  }

  .mosaic-card:hover .mosaic-thumbnail img {
    transform: scale(1.05);
  }

  .mosaic-card-info {
    display: grid;
    gap: var(--spacing-1);
  }

  .mosaic-text-row {
    display: flex;
    gap: var(--spacing-2);
    align-items: flex-start;
  }

  .mosaic-card-name {
    white-space: nowrap;
    flex-shrink: 0;
    transition: color var(--transition-fast);
  }

  .mosaic-card:hover .mosaic-card-name {
    color: var(--color-accent);
  }

  .mosaic-card-description {
    font-size: var(--font-base-size);
    line-height: var(--font-base-height);
    color: var(--color-text);
  }

  .mosaic-arrow {
    display: inline-block;
    transition: transform var(--transition-fast);
  }

  .mosaic-card:hover .mosaic-arrow {
    transform: translateX(var(--spacing-1));
  }

  @media (prefers-reduced-motion: reduce) {
    .mosaic-thumbnail img,
    .mosaic-arrow {
      transition: none;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Collection mosaic",
  "tag": "section",
  "class": "collection-mosaic-section",
  "settings": [
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Collections"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme"
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "limit": 6,
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        },
        {
          "type": "text",
          "id": "description",
          "label": "Description"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Custom image",
          "info": "Overrides the collection image"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collection mosaic"
    }
  ]
}
{% endschema %}
